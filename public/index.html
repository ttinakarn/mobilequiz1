<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="https://unpkg.com/onsenui/css/onsenui.css">
    <link rel="stylesheet" href="https://unpkg.com/onsenui/css/onsen-css-components.min.css">
    <script src="https://unpkg.com/onsenui/js/onsenui.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/material-design-iconic-font/2.2.0/css/material-design-iconic-font.min.css">
    <script src="https://code.jquery.com/jquery-3.3.1.js" integrity="sha256-2Kok7MbOyxpgUVvAk/HJ2jigOSYS2auK4Pfzbm7uH60=" crossorigin="anonymous"></script>
    <script src="ejs.js"></script>
    <title>PSU Mall</title>
</head>

<body>
    <ons-page>
        <ons-toolbar>
            <div class="left">
                <i class="zmdi zmdi-shopping-basket zmdi-hc-2x" style="color: orange; padding: 5px"></i>
            </div>
            <div class="center" id="appname">Home</div>
            <div class="right">
                <i class="zmdi zmdi-info-outline zmdi-hc-2x" style="color: orange; padding: 5px"></i>
                </i>
            </div>
        </ons-toolbar>

        <ons-tabbar swipeable position="auto">
            <ons-tab page="tab1.html" label="Home" icon="ion-home, material:md-home" badge="5930213054" active>
            </ons-tab>
            <ons-tab page="tab2.html" label="Cart" icon="md-shopping-cart">
            </ons-tab>
        </ons-tabbar>
    </ons-page>

    <template id="tab1.html">
        <ons-page id="Tab1">
            <br>
            <div style="text-align: center;">
                <ons-search-input placeholder="Search" onchange="ons.notification.alert('Searched for: ' + this.value)"></ons-search-input>
            </div>
            <br>
            <ons-carousel swipeable auto-scroll overscrollable id="carousel" style="height: 300px;">
                <ons-carousel-item id="carousel1"></ons-carousel-item>
                <ons-carousel-item id="carousel2"></ons-carousel-item>
                <ons-carousel-item id="carousel3"></ons-carousel-item>
            </ons-carousel>
            <br>
                <div id="icons"></div>
                <script id="icon_template" type="text/template">            
                    <ons-row height="150px">
                        <!-- ทำ for each ด้วย -->
                        <% categories.forEach(function(category){ %>
                            <ons-col style="<%= category.style %>" width="33%">
                                <p style="text-align: center;">
                                    <i class="<%= category.icon %>"></i>
                                </p>
                                <p style="text-align: center;"><%= category.name %></p>
                            </ons-col>
                        <% }); %>
                    </ons-row>
                </script>
            <br>
        </ons-page>
    </template>

    <template id="tab2.html">
        <ons-page id="Tab2">
            <ons-list>
                <ons-list-header>Shopping cart</ons-list-header>
                <ons-list-item>
                    <div class="left">
                        <img src="images/item1.jpg" style="height: 50px;">
                    </div>
                    <div class="center">
                        <ons-row>
                            <b>Apple Watch Series 3 GPS 42mm Gray</b>
                        </ons-row>
                        <ons-row style="color: rgb(38, 94, 248)">฿12,650.00</ons-row>
                    </div>
                    <div class="right">
                        <i class="zmdi zmdi-delete zmdi-hc-2x" style="color: grey"></i>
                    </div>
                </ons-list-item>
                <ons-list-item>
                    <div class="left">
                        <img src="images/item2.jpg" style="height: 50px;">
                    </div>
                    <div class="center">
                        <ons-row>
                            <b>MICROLAB SPEAKER 2.1</b>
                        </ons-row>
                        <ons-row style="color: rgb(38, 94, 248)">฿1,570.00</ons-row>
                    </div>

                    <div class="right">
                        <i class="zmdi zmdi-delete zmdi-hc-2x" style="color: grey"></i>
                    </div>
                </ons-list-item>
                <ons-list-item>
                    <div class="left">
                        <img src="images/item3.jpg" style="height: 50px;">
                    </div>
                    <div class="center">
                        <ons-row>
                            <b>Nike Air Max 90 ดำเทาแดง เบอร์ 40</b>
                        </ons-row>
                        <ons-row style="color: rgb(38, 94, 248)">฿2,990.00</ons-row>
                    </div>

                    <div class="right">
                        <i class="zmdi zmdi-delete zmdi-hc-2x" style="color: grey"></i>
                    </div>
                </ons-list-item>
            </ons-list>
            <section style="padding: 8px">
                <ons-button modifier="large">PROCEED TO PAY</ons-button>
            </section>
        </ons-page>
    </template>
</body>
<script>
    getHomeData();
    //อันนี้เป็นตัวเช็คว่าปุ่มไหนโดนกด
    document.addEventListener('prechange', function (event) {
        if (event.index == 0) {
            console.log('Home clicked');
            //ถ้าคลิก home ให้เอาข้อมูลหน้า home มา show
            getHomeData();
        }
        else if (event.index == 1) {
            console.log('Cart clicked');
            //ถ้าคลิก cart ให้เอาข้อมูลหน้า cart มา show
            getCartData();

        }
        // document.querySelector('ons-toolbar .center')
        //     .innerHTML = event.tabItem.getAttribute('label');
    });

    function getHomeData() {
        $.getJSON('home.json', function (data) {
            console.log(data);
            $('#appname').html(data.appname);

            // var style = "background: url('images/" + data.slides[0] + "') no-repeat center; background-size: contain;";
            // $('#carousel1').attr('style', style);
            //$('#carousel1').css("background", data.slides[0]);
            for (var i = 0; i < data.slides.length; i++) {
                let index = i + 1;
                var style = "background: url('images/" + data.slides[i] + "') no-repeat center; background-size: contain;";
                $('#carousel' + index).attr('style', style);
            }

            // $('#icon1').attr('icon', data.categories[0].icon);
            // $('#icon1_text').html(data.categories[0].name);
            // -------------------------------------------------
            // for (var i = 0; i < data.categories.length; i++) {
            //     let index = i + 1;
            //     $('#icon' + index).attr('icon', data.categories[i].icon);
            //     $('#icon' + index + '_text').html(data.categories[i].name);
            // }
            // -------------------------------------------------
            var icon_template = $('#icon_template').html();
            // for (var i = 0; i < data.categories.length; i++) 
            // {
                html = ejs.render(icon_template, {categories: data.categories});
                $('#icons').html(html);
            // }
            console.log();
        })
    }
    function getCartData() {
        $.getJSON('cart.json', function (data) {
            console.log(data);
        })
    }
</script>

</html>